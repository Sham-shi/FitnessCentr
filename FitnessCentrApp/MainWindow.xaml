<ui:FluentWindow
    x:Class="FitnessCentrApp.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:FitnessCentrApp"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:v="clr-namespace:FitnessCentrApp.Views.UserControls"
    xmlns:views="clr-namespace:FitnessCentrApp.Views.UserControls.Base"
    xmlns:vm="clr-namespace:FitnessCentrApp.ViewModels"
    Title="Gains and Pains"
    Width="1000"
    Height="700"
    WindowCornerPreference="Default"
    WindowStartupLocation="CenterOwner"
    mc:Ignorable="d">

    <ui:FluentWindow.InputBindings>
        <KeyBinding
            Key="N"
            Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.CreateCommand}"
            Modifiers="Control" />
        <KeyBinding
            Key="S"
            Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.SaveCommand}"
            Modifiers="Control" />
        <KeyBinding
            Key="E"
            Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.EditCommand}"
            Modifiers="Control" />
        <KeyBinding
            Key="D"
            Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.DeleteCommand}"
            Modifiers="Control" />
        <KeyBinding
            Key="Z"
            Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.RefreshCommand}"
            Modifiers="Control" />
    </ui:FluentWindow.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="45*" />
            <RowDefinition Height="380*" />
        </Grid.RowDefinitions>

        <ui:TitleBar
            Title="Gains and Pains"
            Grid.Row="0"
            Margin="0,0,0,4"
            Padding="8,0"
            ShowClose="True"
            ShowMaximize="True"
            ShowMinimize="True" />

        <Menu Grid.Row="1">
            <ui:MenuItem Header="Файл">
                <ui:MenuItem.Icon>
                    <ui:SymbolIcon Symbol="Document24" />
                </ui:MenuItem.Icon>
                <ui:MenuItem
                    Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.CreateCommand}"
                    Header="Добавить"
                    InputGestureText="Ctrl+N"
                    IsEnabled="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.IsSEditEnabled}">
                    <ui:MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Add24" />
                    </ui:MenuItem.Icon>
                </ui:MenuItem>
                <ui:MenuItem
                    Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.SaveCommand}"
                    Header="Сохранить"
                    InputGestureText="Ctrl+S"
                    IsEnabled="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.IsSaveEnabled}">
                    <ui:MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Save24" />
                    </ui:MenuItem.Icon>
                </ui:MenuItem>
                <Separator />
                <ui:MenuItem
                    Name="Exit"
                    Click="Exit_Click"
                    Header="Выход"
                    InputGestureText="Alt+F4">
                    <ui:MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Door28" />
                    </ui:MenuItem.Icon>
                </ui:MenuItem>
            </ui:MenuItem>
            <Separator />

            <ui:MenuItem Header="Правка">
                <ui:MenuItem.Icon>
                    <ui:SymbolIcon Symbol="Compose24" />
                </ui:MenuItem.Icon>
                <ui:MenuItem
                    Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.EditCommand}"
                    Header="Редактировать"
                    InputGestureText="Ctrl+E"
                    IsEnabled="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.IsSEditEnabled}">
                    <ui:MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Edit24" />
                    </ui:MenuItem.Icon>
                </ui:MenuItem>
                <ui:MenuItem
                    Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.DeleteCommand}"
                    Header="Удалить"
                    InputGestureText="Ctrl+D"
                    IsEnabled="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.IsSEditEnabled}">
                    <ui:MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Delete24" />
                    </ui:MenuItem.Icon>
                </ui:MenuItem>
                <Separator />
                <ui:MenuItem
                    Command="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.RefreshCommand}"
                    Header="Отменить"
                    InputGestureText="Ctrl+Z"
                    IsEnabled="{Binding ElementName=MainTabControl, Path=SelectedItem.Content.DataContext.IsSaveEnabled}">
                    <ui:MenuItem.Icon>
                        <ui:SymbolIcon Symbol="ArrowCounterclockwise24" />
                    </ui:MenuItem.Icon>
                </ui:MenuItem>
            </ui:MenuItem>
            <Separator />

            <ui:MenuItem Header="Настройки">
                <ui:MenuItem.Icon>
                    <ui:SymbolIcon Symbol="Settings24" />
                </ui:MenuItem.Icon>

                <ui:MenuItem Header="Темы">
                    <ui:MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Color24" />
                    </ui:MenuItem.Icon>
                    <ui:MenuItem
                        Name="LightTheme"
                        Click="LightTheme_Click"
                        Header="Светлая">
                        <ui:MenuItem.Icon>
                            <ui:SymbolIcon Symbol="WeatherSunny24" />
                        </ui:MenuItem.Icon>
                    </ui:MenuItem>
                    <ui:MenuItem
                        Name="DarkTheme"
                        Click="DarkTheme_Click"
                        Header="Тёмная">
                        <ui:MenuItem.Icon>
                            <ui:SymbolIcon Symbol="WeatherMoon24" />
                        </ui:MenuItem.Icon>
                    </ui:MenuItem>
                    <ui:MenuItem
                        Name="SystemTheme"
                        Click="SystemTheme_Click"
                        Header="Системная">
                        <ui:MenuItem.Icon>
                            <ui:SymbolIcon Symbol="Desktop24" />
                        </ui:MenuItem.Icon>
                    </ui:MenuItem>
                </ui:MenuItem>
                <Separator />

                <ui:MenuItem Header="База данных">
                    <ui:MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Database24" />
                    </ui:MenuItem.Icon>

                    <ui:MenuItem.DataContext>
                        <vm:DatabaseSettingsViewModel />
                    </ui:MenuItem.DataContext>

                    <ui:MenuItem Command="{Binding UseSqliteCommand}" Header="Использовать SQLite" IsCheckable="True">
                        <ui:MenuItem.Icon>
                            <ui:SymbolIcon Symbol="DataHistogram24" />
                        </ui:MenuItem.Icon>
                    </ui:MenuItem>

                    <ui:MenuItem Command="{Binding UseMssqlCommand}" Header="Использовать MSSQL" IsCheckable="True" >
                        <ui:MenuItem.Icon>
                            <ui:SymbolIcon Symbol="DataBarVertical24" />
                        </ui:MenuItem.Icon>
                    </ui:MenuItem>

                    <Separator />
                    <ui:MenuItem Header="{Binding CurrentDatabase, StringFormat=Текущая: {0}}" IsEnabled="False" />

                </ui:MenuItem>
            </ui:MenuItem>
        </Menu>

        <TabControl
            x:Name="MainTabControl"
            Grid.Row="2"
            Margin="5,10,0,5">
            <TabItem Name="BranchesTab" Header="Филиалы">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Margin="0,0,5,0" Symbol="BuildingMultiple24" />
                            <TextBlock Text="Филиалы" />
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>

                <views:CrudView>
                    <views:CrudView.DataContext>
                        <vm:BranchesViewModel />
                    </views:CrudView.DataContext>
                </views:CrudView>
            </TabItem>

            <TabItem Name="TrainersTab" Header="Тренеры">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Margin="0,0,5,0" Symbol="People24" />
                            <TextBlock Text="Тренеры" />
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>

                <views:CrudView>
                    <views:CrudView.DataContext>
                        <vm:TrainersViewModel />
                    </views:CrudView.DataContext>
                </views:CrudView>
            </TabItem>

            <TabItem Name="ServicesTab" Header="Услуги">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Margin="0,0,5,0" Symbol="ServiceBell24" />
                            <TextBlock Text="Услуги" />
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>

                <views:CrudView>
                    <views:CrudView.DataContext>
                        <vm:ServicesViewModel />
                    </views:CrudView.DataContext>
                </views:CrudView>
            </TabItem>

            <TabItem Name="ClientsTab" Header="Клиенты">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Margin="0,0,5,0" Symbol="PeopleAudience24" />
                            <TextBlock Text="Клиенты" />
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>

                <views:CrudView>
                    <views:CrudView.DataContext>
                        <vm:ClientsViewModel />
                    </views:CrudView.DataContext>
                </views:CrudView>
            </TabItem>

            <TabItem Name="BookingsTab" Header="Записи">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Margin="0,0,5,0" Symbol="CalendarAgenda24 " />
                            <TextBlock Text="Записи" />
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>

                <views:CrudView>
                    <views:CrudView.DataContext>
                        <vm:BookingsViewModel />
                    </views:CrudView.DataContext>
                </views:CrudView>
            </TabItem>
        </TabControl>
    </Grid>
</ui:FluentWindow>
